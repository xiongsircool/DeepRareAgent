"""
åˆ†æ MDT å­å›¾ä¸­æ‰€æœ‰èŠ‚ç‚¹çš„ messages å¤„ç†æƒ…å†µ
"""

print("=" * 80)
print("MDT å­å›¾èŠ‚ç‚¹ messages å¤„ç†åˆ†æ")
print("=" * 80)

nodes_analysis = [
    {
        "èŠ‚ç‚¹å": "triage_to_mdt_node",
        "æ–‡ä»¶": "p02_mdt/nodes.py:19",
        "è¿”å› messages": "âœ… æ˜¯",
        "æ¶ˆæ¯å†…å®¹": "ğŸ”¬ æ­£åœ¨åˆå§‹åŒ–å¤šä¸“å®¶ä¼šè¯Šç³»ç»Ÿï¼Œå·²åˆ†é… N ä¸ªä¸“å®¶ç»„...",
        "ä¿®å¤çŠ¶æ€": "âœ… å·²ä¿®å¤",
        "æ˜¯å¦å¿…è¦": "âœ… å¿…è¦ï¼ˆç”¨æˆ·éœ€è¦çœ‹åˆ° MDT å¯åŠ¨æç¤ºï¼‰",
        "å¤‡æ³¨": "å·²åœ¨ä¿®å¤ä¸­æ·»åŠ "
    },
    {
        "èŠ‚ç‚¹å": "expert nodes (group_1, group_2, ...)",
        "æ–‡ä»¶": "p02_mdt/builddeepexportnode.py:245-250",
        "è¿”å› messages": "âŒ å¦",
        "æ¶ˆæ¯å†…å®¹": "æ— ï¼ˆåªè¿”å› expert_pool æ›´æ–°ï¼‰",
        "ä¿®å¤çŠ¶æ€": "âš ï¸  æœªä¿®å¤",
        "æ˜¯å¦å¿…è¦": "ğŸ¤” å¯é€‰ï¼ˆä¸“å®¶è¯Šæ–­è¿‡ç¨‹å¯¹ç”¨æˆ·æ˜¯é»‘ç›’ï¼Œä¸ä¸€å®šéœ€è¦å®æ—¶åé¦ˆï¼‰",
        "å¤‡æ³¨": "å¹¶è¡Œæ‰§è¡Œï¼Œå¦‚æœæ·»åŠ æ¶ˆæ¯ä¼šæœ‰å¤šæ¡åŒæ—¶å‡ºç°"
    },
    {
        "èŠ‚ç‚¹å": "expert_review",
        "æ–‡ä»¶": "p02_mdt/export_reviwer_node.py:137",
        "è¿”å› messages": "âœ… æ˜¯",
        "æ¶ˆæ¯å†…å®¹": "âœ… ç¬¬ N è½®ä¸“å®¶äº’å®¡å®Œæˆ (æ»¡æ„åº¦: X/Y) - å·²è¾¾æˆå…±è¯†ï¼",
        "ä¿®å¤çŠ¶æ€": "âœ… å·²ä¿®å¤",
        "æ˜¯å¦å¿…è¦": "âœ… å¿…è¦ï¼ˆç”¨æˆ·éœ€è¦çœ‹åˆ°æ¯è½®è¿›åº¦ï¼‰",
        "å¤‡æ³¨": "å·²åœ¨ä¿®å¤ä¸­æ·»åŠ "
    },
    {
        "èŠ‚ç‚¹å": "routing_decision",
        "æ–‡ä»¶": "p02_mdt/nodes.py:63-101",
        "è¿”å› messages": "âŒ å¦",
        "æ¶ˆæ¯å†…å®¹": "æ— ï¼ˆåªåšè·¯ç”±åˆ¤æ–­ï¼Œè¿”å› {}ï¼‰",
        "ä¿®å¤çŠ¶æ€": "âš ï¸  æœªä¿®å¤",
        "æ˜¯å¦å¿…è¦": "âŒ ä¸å¿…è¦ï¼ˆçº¯é€»è¾‘èŠ‚ç‚¹ï¼Œä¸éœ€è¦ç”¨æˆ·å¯è§ï¼‰",
        "å¤‡æ³¨": "åªæ‰“å°æ—¥å¿—ï¼Œä¸ä¿®æ”¹çŠ¶æ€"
    },
    {
        "èŠ‚ç‚¹å": "fan_out",
        "æ–‡ä»¶": "p02_mdt/nodes.py:107-121",
        "è¿”å› messages": "âŒ å¦",
        "æ¶ˆæ¯å†…å®¹": "æ— ï¼ˆåªæ‰“å°æ—¥å¿—ï¼Œè¿”å› {}ï¼‰",
        "ä¿®å¤çŠ¶æ€": "âš ï¸  æœªä¿®å¤",
        "æ˜¯å¦å¿…è¦": "ğŸ¤” å¯é€‰ï¼ˆæç¤ºå¼€å§‹æ–°ä¸€è½®è¯Šæ–­ï¼‰",
        "å¤‡æ³¨": "åªåœ¨å¤šè½®åœºæ™¯ä¸‹æ‰§è¡Œ"
    }
]

print("\nèŠ‚ç‚¹è¯¦ç»†åˆ†æï¼š")
print("-" * 80)
for i, node in enumerate(nodes_analysis, 1):
    print(f"\n{i}. {node['èŠ‚ç‚¹å']}")
    print(f"   æ–‡ä»¶ä½ç½®: {node['æ–‡ä»¶']}")
    print(f"   è¿”å› messages: {node['è¿”å› messages']}")
    print(f"   æ¶ˆæ¯å†…å®¹: {node['æ¶ˆæ¯å†…å®¹']}")
    print(f"   ä¿®å¤çŠ¶æ€: {node['ä¿®å¤çŠ¶æ€']}")
    print(f"   æ˜¯å¦å¿…è¦: {node['æ˜¯å¦å¿…è¦']}")
    print(f"   å¤‡æ³¨: {node['å¤‡æ³¨']}")

print("\n" + "=" * 80)
print("æ±‡æ€»ç»Ÿè®¡")
print("=" * 80)
total = len(nodes_analysis)
fixed = sum(1 for n in nodes_analysis if "âœ… å·²ä¿®å¤" in n["ä¿®å¤çŠ¶æ€"])
not_fixed = sum(1 for n in nodes_analysis if "âš ï¸  æœªä¿®å¤" in n["ä¿®å¤çŠ¶æ€"])
necessary = sum(1 for n in nodes_analysis if "âœ… å¿…è¦" in n["æ˜¯å¦å¿…è¦"])
optional = sum(1 for n in nodes_analysis if "ğŸ¤” å¯é€‰" in n["æ˜¯å¦å¿…è¦"])
not_necessary = sum(1 for n in nodes_analysis if "âŒ ä¸å¿…è¦" in n["æ˜¯å¦å¿…è¦"])

print(f"æ€»èŠ‚ç‚¹æ•°: {total}")
print(f"å·²ä¿®å¤: {fixed}")
print(f"æœªä¿®å¤: {not_fixed}")
print(f"å¿…è¦æ·»åŠ : {necessary}")
print(f"å¯é€‰æ·»åŠ : {optional}")
print(f"ä¸å¿…è¦: {not_necessary}")

print("\n" + "=" * 80)
print("å½“å‰çŠ¶æ€è¯„ä¼°")
print("=" * 80)
print(f"âœ… æ ¸å¿ƒåŠŸèƒ½å·²ä¿®å¤: {fixed}/{necessary} ä¸ªå¿…è¦èŠ‚ç‚¹å·²å¤„ç†")
print(f"âš ï¸  å¯é€‰ä¼˜åŒ–é¡¹: {not_fixed - not_necessary} ä¸ªèŠ‚ç‚¹å¯ä»¥è€ƒè™‘æ·»åŠ æ¶ˆæ¯")
print(f"ğŸ“ å»ºè®®: å½“å‰ä¿®å¤å·²è¦†ç›–ä¸»è¦ç”¨æˆ·ä½“éªŒç‚¹ï¼Œå¯é€‰é¡¹å¯ä»¥æ ¹æ®å®é™…éœ€è¦æ·»åŠ ")
