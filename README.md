<p align="center">
  <img src="images/hero_banner.png" alt="DeepRareAgent Banner" width="100%">
</p>

# DeepRareAgent

**é¢å‘ç½•è§ç—…è¯Šæ–­çš„å¤šç»„ MDT é›†æˆç³»ç»Ÿ (Multi-Team MDT Ensemble for Rare Disease Diagnosis)**

---

## é¡¹ç›®ç®€ä»‹

**DeepRareAgent** æ˜¯ä¸€ä¸ªä¸“ä¸ºç½•è§ç—…è¯Šæ–­è®¾è®¡çš„ AI è¾…åŠ©ç³»ç»Ÿã€‚å…¶æ ¸å¿ƒä¸æ˜¯ç®€å•çš„"ä¸€æ¡è·¯"è¯Šæ–­ï¼Œè€Œæ˜¯æ¨¡æ‹ŸåŒ»é™¢é‡Œç”±å¤šä¸ªç‹¬ç«‹å›¢é˜Ÿå‚ä¸çš„ **å¤šç»„å¤šå­¦ç§‘ä¼šè¯Š (Multi-Team MDT)** æœºåˆ¶ã€‚

**æ ¸å¿ƒæ€æƒ³**ï¼šè®©å¤šä¸ª"å…¨èƒ½"çš„ MDT å›¢é˜Ÿå„è‡ªç‹¬ç«‹åˆ†æåŒä¸€ä¸ªå¤æ‚ç—…ä¾‹ï¼Œç„¶åå°†å„å›¢é˜Ÿçš„è¯Šæ–­æ„è§è¿›è¡Œäº¤å‰éªŒè¯ä¸è¿­ä»£æ‹Ÿåˆï¼Œæœ€ç»ˆè¾“å‡ºä¸€ä»½é«˜ç½®ä¿¡åº¦çš„ç»¼åˆæŠ¥å‘Šã€‚

![ç³»ç»Ÿæ¶æ„](images/multi_team_mdt_arch.png)

---

## æ ¸å¿ƒç‰¹æ€§

### 1. å¤šæ™ºèƒ½ä½“å›¢é˜Ÿå¹¶è¡Œ (Multi-Team Parallelism)

ç³»ç»Ÿå¯é…ç½® **N ä¸ªç‹¬ç«‹çš„è¯Šæ–­ç»„ (Group)**ï¼Œå¦‚ `group_1`, `group_2`ã€‚æ¯ä¸ª Group æ˜¯ä¸€ä¸ªåŠŸèƒ½å®Œæ•´çš„ AI å›¢é˜Ÿï¼š

| è§’è‰² | è¯´æ˜ |
|---|---|
| **Main Agent (ä¸»æ§)** | è´Ÿè´£æ•´ä½“è¯Šæ–­è§„åˆ’ã€é€»è¾‘æ•´åˆä¸æŠ¥å‘Šæ’°å†™ã€‚ |
| **Sub-Agent 1 (Phenotype Analyst)** | è´Ÿè´£è°ƒç”¨ HPO è¡¨å‹æœ¬ä½“å·¥å…·ï¼Œå°†ç—‡çŠ¶æ ‡å‡†åŒ–ã€‚ |
| **Sub-Agent 2 (Literature Researcher)** | è´Ÿè´£è°ƒç”¨ PubMedã€æœç´¢å¼•æ“ç­‰å·¥å…·æ£€ç´¢è¯æ®ã€‚ |

æ¯ä¸ªå›¢é˜Ÿ**ç‹¬ç«‹è¿›è¡Œ**ä»ç—‡çŠ¶åˆ†æã€æ–‡çŒ®æ£€ç´¢åˆ°æŠ¥å‘Šè¾“å‡ºçš„å®Œæ•´æµç¨‹ï¼Œå½¼æ­¤ä¸å¹²æ‰°ã€‚

### 2. å…±è¯†ä¸æ‹Ÿåˆ (Consensus & Fitting)

æ‰€æœ‰å›¢é˜Ÿå®Œæˆè¯Šæ–­åï¼Œç³»ç»Ÿä¸ä¼šç®€å•å–å¹³å‡æˆ–æŠ•ç¥¨ã€‚è€Œæ˜¯ï¼š
1.  **Expert Review Node**: ä¸€ä¸ªä¸“é—¨çš„èŠ‚ç‚¹è´Ÿè´£å¯¹æ¯”å„ç»„æŠ¥å‘Šï¼Œæå–å†²çªç‚¹å’Œå…±åŒè®¤çŸ¥ã€‚
2.  **Blackboard (å…¬å…±é»‘æ¿)**: å„ç»„æŠ¥å‘Šã€åˆ†æ­§ä¸å…±è¯†ä¼šè¢«å‘å¸ƒåˆ°é»‘æ¿ä¸Šã€‚
3.  **å¤šè½®è¿­ä»£ (Multi-Round Loop)**: å¦‚æœå…±è¯†æœªè¾¾æˆï¼Œç³»ç»Ÿä¼šå¯åŠ¨æ–°ä¸€è½®è¯Šæ–­ï¼Œå„ç»„é˜…è¯»é»‘æ¿ä¸Šçš„ä¿¡æ¯åé‡æ–°åˆ†æï¼Œç›´åˆ°è¾¾æˆå…±è¯†æˆ–è½®æ•°è€—å°½ã€‚

### 3. ä¸‰é˜¶æ®µæµç¨‹

æ•´ä¸ªç³»ç»Ÿåˆ†ä¸ºä¸‰ä¸ªä¸»è¦é˜¶æ®µï¼š

| é˜¶æ®µ | èŠ‚ç‚¹ | åŠŸèƒ½ |
|---|---|---|
| **P01: Pre-Diagnosis** | `prediagnosis` | æ™ºèƒ½é—®è¯Šï¼Œæ”¶é›†æ‚£è€…åŸºæœ¬ä¿¡æ¯ã€ç—‡çŠ¶ã€å®¶æ—å²ã€‚å½“ä¿¡æ¯è¶³å¤Ÿæ—¶ï¼Œåˆ¤æ–­æ˜¯å¦éœ€è¦å¯åŠ¨æ·±åº¦è¯Šæ–­ã€‚ |
| **P02: MDT Diagnosis** | `mdt_diagnosis` (å­å›¾) | å¤šç»„ä¸“å®¶å¹¶è¡Œåˆ†æï¼Œç»è¿‡å¤šè½®è¿­ä»£è¾¾æˆå…±è¯†ã€‚ |
| **P03: Summary** | `summary` | æ•´åˆæ‰€æœ‰ä¸“å®¶ç»„æŠ¥å‘Šï¼Œç”Ÿæˆæœ€ç»ˆçš„ç»¼åˆè¯Šæ–­æŠ¥å‘Šã€‚ |

---

## é¡¹ç›®ç»“æ„

```
DeepRareAgent/
â”œâ”€â”€ DeepRareAgent/
â”‚   â”œâ”€â”€ graph.py                    # ä¸»å›¾å®šä¹‰ (P01 -> P02 -> P03)
â”‚   â”œâ”€â”€ schema.py                   # çŠ¶æ€å®šä¹‰ (MainGraphState, MDTGraphState, ExpertGroupState)
â”‚   â”œâ”€â”€ p01pre_diagnosis_agent.py   # é¢„è¯Šæ–­æ™ºèƒ½ä½“
â”‚   â”œâ”€â”€ p02_mdt/
â”‚   â”‚   â”œâ”€â”€ graph.py                # MDT å­å›¾å®šä¹‰
â”‚   â”‚   â”œâ”€â”€ builddeepexportnode.py  # ä¸“å®¶ç»„èŠ‚ç‚¹å·¥å‚ (æ„å»º Main/Sub Agent çº§è”)
â”‚   â”‚   â”œâ”€â”€ nodes.py                # è·¯ç”±ã€æ‰‡å‡ºç­‰è¾…åŠ©èŠ‚ç‚¹
â”‚   â”‚   â””â”€â”€ export_reviwer_node.py  # ä¸“å®¶äº’å®¡/å…±è¯†èŠ‚ç‚¹
â”‚   â”œâ”€â”€ p03summary_agent.py         # æ±‡æ€»æŠ¥å‘ŠèŠ‚ç‚¹
â”‚   â”œâ”€â”€ tools/                      # å„ç±»å·¥å…· (HPO, PubMed, æœç´¢ç­‰)
â”‚   â””â”€â”€ prompts/                    # å„æ™ºèƒ½ä½“çš„ç³»ç»Ÿæç¤ºè¯
â”œâ”€â”€ config.yml                      # ä¸»é…ç½®æ–‡ä»¶ (æ¨¡å‹ã€API Keyã€Group å®šä¹‰)
â””â”€â”€ langgraph.json                  # LangGraph æœåŠ¡é…ç½®
```

---

## å¿«é€Ÿå¼€å§‹

### 1. å®‰è£…ä¾èµ–

```bash
pip install -e . "langgraph-cli[inmem]"
```

### 2. é…ç½®

```bash
# å¤åˆ¶é…ç½®æ¨¡æ¿
cp config.example.yml config.yml
cp .env.example .env

# ç¼–è¾‘ config.ymlï¼Œå¡«å…¥ä½ çš„ LLM API Key å’Œ Base URL
```

### 3. å¯åŠ¨æœåŠ¡

```bash
langgraph dev
```

*   **API**: `http://127.0.0.1:2024`
*   **LangGraph Studio**: `https://smith.langchain.com/studio/?baseUrl=http://127.0.0.1:2024`

---

## é…ç½®è¯´æ˜

åœ¨ `config.yml` ä¸­ï¼Œ`multi_expert_diagnosis_agent` ä¸‹çš„æ¯ä¸ª `group_*` éƒ½æ˜¯ä¸€ä¸ªç‹¬ç«‹çš„è¯Šæ–­å›¢é˜Ÿã€‚ä½ å¯ä»¥ï¼š
*   å¢åŠ æˆ–å‡å°‘ Group æ•°é‡ã€‚
*   ä¸ºæ¯ä¸ª Group é…ç½®ä¸åŒçš„æ¨¡å‹ï¼ˆå¦‚ group_1 ç”¨ GPT-4ï¼Œgroup_2 ç”¨ Claudeï¼‰ã€‚
*   ä¸ºæ¯ä¸ª Sub-Agent é…ç½®ä¸åŒçš„å·¥å…·é›†ã€‚

```yaml
multi_expert_diagnosis_agent:
  group_1:
    main_agent:
      name: "Clinical_Lead_G1"
      model_name: "gpt-4o"
      ...
    sub_agent:
      sub_agent_1:  # Phenotype Analyst
        ...
      sub_agent_2:  # Literature Researcher
        ...
  group_2:
    # ... åŒä¸Šï¼Œå¯ä½¿ç”¨ä¸åŒæ¨¡å‹
```

---

## ğŸ“š å‚è€ƒä¸è¯„ä¼° (References & Benchmarking)

DeepRareAgent çš„è®¾è®¡ä¸éªŒè¯å‚è€ƒäº†ä»¥ä¸‹ 2024-2025 å¹´çš„é¡¶åˆŠä¸å‰æ²¿å·¥ä½œï¼š

| æ¥æº | è®ºæ–‡/é¡¹ç›® | æ ¸å¿ƒè´¡çŒ®ä¸è¯„ä¼°ä½“ç³» |
| :--- | :--- | :--- |
| **ArXiv '24** | **RareAgents** (Chen et al.) | æå‡ºäº†ç½•è§ç—… MDT æ¡†æ¶ï¼Œä½¿ç”¨ **RareBench (1,197 ç—…ä¾‹)** è¿›è¡Œ Top-K å‡†ç¡®ç‡è¯„ä¼°ï¼Œæ˜¯æœ¬é¡¹ç›®çš„ç›´æ¥å¯¹æ ‡åŸºå‡†ã€‚ |
| **Nature '25** | **AMIE** (Google) | å®šä¹‰äº† AI é—®è¯Šçš„é»„é‡‘æ ‡å‡†ï¼š**æ¨¡æ‹Ÿé—®è¯Š (Simulated Consultations)** ä¸åŒç›²éšæœºå¯¹ç…§è¯•éªŒ (RCT)ã€‚ |
| **ArXiv '25** | **MDTeamGPT** | éªŒè¯äº†å¤š Agents åœ¨ MDT åœºæ™¯ä¸‹çš„å…±è¯†æœºåˆ¶ï¼Œä½¿ç”¨ MedQA å’Œ PubMedQA è¯„ä¼°ï¼Œå¹¶å¼•å…¥äº†äººç±»ä¸“å®¶ blind reviewã€‚ |
| **ArXiv '25** | **DiagnosisArena** | è¶…è¶Šç®€å•é—®ç­”ï¼Œä½¿ç”¨ 1,113 ä¸ªç»“æ„åŒ–ç—…ä¾‹è¯„ä¼° Agent çš„ **è¯Šæ–­æ¨ç†è·¯å¾„ (Reasoning Paths)**ã€‚ |
| **NEJM AI '25** | **MedAgentBench** | åœ¨è™šæ‹Ÿ EHR ç¯å¢ƒä¸­æµ‹è¯• Agent æ¨¡æ‹ŸåŒ»ç”Ÿå…¨æµç¨‹æ“ä½œçš„èƒ½åŠ›ï¼ˆå¼€è¯ã€æŸ¥ç—…å†ï¼‰ã€‚ |
| **NeurIPS '24** | **MDAgents** | æå‡ºäº† "Adaptive Collaboration"ï¼Œè¯æ˜äº†æ ¹æ®ç—…ä¾‹éš¾åº¦åŠ¨æ€è°ƒæ•´ Agent æ•°é‡çš„æœ‰æ•ˆæ€§ã€‚ |

---

## ğŸ”® 2026 åˆ›æ–°è·¯çº¿å›¾ (Future Roadmap)

ä¸ºäº†åº”å¯¹ 2026 å¹´çš„å­¦æœ¯æŒ‘æˆ˜ï¼Œæœ¬é¡¹ç›®è®¡åˆ’åœ¨ä»¥ä¸‹ç»´åº¦è¿›è¡Œæ¶æ„å‡ç»´ï¼š

### 1. è®¤çŸ¥æ¶æ„å‡çº§ï¼šå¯¹æŠ—æ€§åä½œ (Adversarial Collaboration)
*   å¼•å…¥ **"Red Team" (çº¢é˜Ÿ)** æœºåˆ¶ï¼šåœ¨å…±è¯†è¾¾æˆå‰ï¼Œå¼ºåˆ¶å®ä¾‹åŒ–ä¸€ä¸ª"åå¯¹è€…"æ™ºèƒ½ä½“ï¼Œä¸“é—¨å¯»æ‰¾è¯Šæ–­é€»è¾‘æ¼æ´ã€‚
*   **ç›®çš„**ï¼šè§£å†³ç¾¤ä½“æ€ç»´ (Groupthink) å’Œçº§è”å¹»è§‰ï¼Œä»å•çº¯çš„"è¾¾æˆå…±è¯†"è¿›åŒ–ä¸º"ç»å¾—èµ·æŒ‘æˆ˜çš„çœŸç†"ã€‚

### 2. Neuro-Symbolic èåˆï¼šçŸ¥è¯†å›¾è°±ä¸ç—…ä¾‹åº“ (Proposed)
*   **Knowledge Graph Agent**: æ¥å…¥ç”Ÿç‰©åŒ»å­¦çŸ¥è¯†å›¾è°± (å¦‚ Hetionet, PrimeKG)ï¼Œè¿›è¡Œç¡®å®šæ€§çš„å¤šè·³é€»è¾‘æ¨ç†ï¼Œå¼¥è¡¥ LLM çš„æ¦‚ç‡æ€§ç¼ºé™·ã€‚
*   **Similar Case Retrieval Agent**: åŸºäº Case-Based Reasoning (CBR) æ€æƒ³ï¼Œæ£€ç´¢å†å²ç›¸ä¼¼ç—…ä¾‹åº“ï¼Œæä¾›"å¾ªè¯"æ”¯æŒã€‚

### 3. å¤šæ¨¡æ€åŸç”Ÿ (Native Multimodal)
*   æ‰©å±•è¾“å…¥çš„ç»´åº¦ï¼Œæ”¯æŒ **VCF åŸºå› æ•°æ®** çš„ç›´æ¥è§£æä¸ **åŒ»å­¦å½±åƒ (DICOM)** çš„ç‰¹å¾æå–ï¼Œå°†æ–‡æœ¬è¯Šæ–­æ‰©å±•ä¸ºå¤šæ¨¡æ€ç»¼åˆè¯Šæ–­ã€‚

### 4. å¯ä¿¡ AIï¼šè¯Šæ–­å½’å› å›¾ (Diagnostic Attribution)
*   è¾“å‡ºç»“æœä¸å†æ˜¯å•ä¸€æ–‡æœ¬ï¼Œè€Œæ˜¯åŒ…å«è¯æ®æº¯æºçš„ **å½’å› å›¾**ï¼Œæ˜ç¡®æ¯ä¸€æ¡è¯Šæ–­ç»“è®ºå¼•ç”¨çš„å…·ä½“æ–‡çŒ®ã€æŒ‡å—æ¡æ¬¾æˆ–å›¾è°±èŠ‚ç‚¹ã€‚

---
## åç»­ä»»åŠ¡
- [ ] æ”¯æŒå®šåˆ¶æ€»ç»“æŠ¥å‘Š
- [ ] çŸ¥è¯†å›¾è°±å­æ™ºèƒ½ä½“
- [ ] ç§æœ‰ç—…ä¾‹æ•°æ®é›†æ”¯æŒæ™ºèƒ½ä½“ 
- [ ] æ‚£è€…ä¿¡æ¯å‡çº§å¤šæ¨¡æ€æ•°æ®é›†ç®¡ç†
- [ ] ä¸ªäººå˜å¼‚æ–‡ä»¶æ”¯æŒæ™ºèƒ½ä½“ 

## è®¸å¯è¯

MIT License - è¯¦è§ [LICENSE](LICENSE)æ–‡ä»¶